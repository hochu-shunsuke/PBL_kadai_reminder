# 名城大学生向け 課題管理リマインドシステム

## 概要
このシステムは、名城大学のWebClassおよびGoogle Classroomで出された課題を自動的に取得し、Google Tasks（ToDoリスト）に一括登録するツールです。

Googleスプレッドシート上で動作し、一度設定を行えば、毎日決まった時間に自動で課題を確認・更新します。スマートフォンにGoogle Tasksアプリを入れておけば、課題の締め切り通知をスマホで受け取ることができるようになります。

## 特徴
*   **誰でも簡単に使える**: プログラミングの知識は不要です。スプレッドシートのメニューから数回クリックするだけで設定が完了します。
*   **自動更新**: 毎日指定した時間にシステムが自動で起動し、新しい課題がないかチェックします。
*   **一元管理**: WebClassとGoogle Classroomの両方の課題を、Google Tasksという一つのアプリでまとめて管理できます。
*   **スマホ通知**: Google Tasksアプリをインストールすることで、課題の締め切り前に通知を受け取ることができます。

## 使い方（セットアップ手順）

配布されたスプレッドシートを開き、以下の手順で設定を行ってください。

### 事前準備
*   PCでの操作を推奨します。
*   複数のGoogleアカウントにログインしている場合、うまく動作しないことがあります。その場合は、Google Chromeの「シークレットウィンドウ」などを使い、大学のGoogleアカウントのみでログインした状態でスプレッドシートを開いてください。

### 手順1: WebClassの認証設定
1.  スプレッドシート上部のメニューバーにある **「✨ 課題自動取得システム」** をクリックします。
    *   ※ 初回実行時は「承認」を求められる画面が表示されます。画面の指示に従って承認（許可）を行ってください。
2.  表示されたメニューから **「1. WebClass 認証情報を設定 (ID/PW)」** を選択します。
3.  設定画面が表示されるので、WebClassのログインに使用する **学籍番号** と **パスワード** を入力し、「保存」をクリックします。
    *   入力されたパスワードは、あなた自身のGoogleアカウント内の安全な領域に保存され、外部に送信されることはありません。

### 手順2: 通知と自動実行の設定
1.  再度メニューの **「✨ 課題自動取得システム」** をクリックします。
2.  **「2. Tasks・自動実行設定を完了 (初回のみ)」** を選択します。
3.  以下の項目を設定し、「設定を保存して連携」をクリックします。
    *   **Tasksリスト名**: Google Tasksに作成されるリストの名前（例: 大学課題）。
    *   **実行時間**: 毎日何時ごろに課題チェックを行うか（例: 6）。
    *   **削除猶予**: 完了した課題をリストから削除するまでの日数。

### 手順3: 動作確認
1.  メニューから **「3. 今すぐ実行（テスト）」** を選択します。
2.  スクリプトが実行され、WebClassやClassroomから課題が取得されます。
3.  Google Tasks（Gmailの右サイドバーやスマホアプリ）を開き、指定したリストに課題が追加されていることを確認してください。

以上で設定は完了です。以降は毎日自動的に課題が更新されます。

## 技術的な解説

このシステムは Google Apps Script (GAS) を使用して構築されています。本リポジトリのコードに関心がある方向けに、技術的な仕組みを解説します。

### システム構成
*   **プラットフォーム**: Google Apps Script (Container-bound Script)
*   **フロントエンド**: HTML Service (Bootstrap 5) を使用した設定ダイアログ
*   **データ保存**: ScriptProperties（認証情報など）、Spreadsheet（ログ、取得データ一時保存）

### 処理フロー
1.  **認証**:
    *   `WebClassClient.js` が WebClass のログイン処理を担当します。
    *   `UrlFetchApp` を使用し、SSO認証およびSAML認証のリダイレクトフローを追跡してセッションCookieを取得・維持します。
2.  **データ取得**:
    *   **WebClass**: ログイン後のダッシュボードHTMLを解析 (`Parser.js`) し、受講中のコース一覧と各コース内の課題情報をスクレイピングします。
    *   **Google Classroom**: Advanced Google Services の Classroom API を使用して、正規の方法で課題データを取得します。
3.  **データ整形と登録**:
    *   取得したデータは `AppLogic.js` で整理され、重複チェックを行った上で Google Tasks API を通じてユーザーのタスクリストに追加されます。
4.  **自動実行**:
    *   GASのTime-drivenトリガーを使用し、ユーザーが指定した時間に `Main.js` のエントリーポイント関数を実行します。

### ファイル構成
*   `Main.js`: アプリケーションのエントリーポイント。メニュー作成、トリガー設定、各ダイアログの呼び出しを行います。
*   `AppLogic.js`: 課題取得からTasks登録までのメインロジックを記述しています。
*   `WebClassClient.js`: WebClassへのHTTPリクエスト、Cookie管理、リダイレクト処理をカプセル化したクラスです。
*   `Parser.js`: WebClassのHTMLから必要な情報を抽出するための正規表現ロジックを含みます。
*   `Config.js`: URLや正規表現などの定数定義ファイルです。
*   `Utils.js`: ログ出力、設定値の保存・読み出し、共通ヘルパー関数などをまとめています。
*   `Setting.html` / `Setting_Tasks.html`: 設定ダイアログのUI定義ファイルです。

## 注意事項
*   WebClassの仕様変更（HTML構造の変更など）により、正しく動作しなくなる可能性があります。
*   パスワードなどの機密情報は `PropertiesService.getUserProperties()` を使用してユーザーごとのプロパティストアに保存されます。これはスクリプトの実行者（ユーザー自身）のみがアクセス可能な領域です。
*   本システムは大学公式のものではありません。
